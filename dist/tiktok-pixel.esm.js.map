{"version":3,"file":"tiktok-pixel.esm.js","sources":["../src/index.tsx"],"sourcesContent":["let debug = false;\nlet initialized = false;\n\nconst warn = (...args: any) => {\n  if (!debug) {\n    return;\n  }\n  console.info(...['[tiktok-pixel]'].concat(args));\n};\n\nconst verifyInit = () => {\n  if (!initialized) {\n    warn(\n      'Pixel not initialized before using call tiktokPixel.init with required params'\n    );\n  }\n  return initialized;\n};\n\nconst log = (...args: any) => {\n  if (!debug) {\n    return;\n  }\n  // eslint-disable-next-line no-console\n  console.info(...['[tiktok-pixel]'].concat(args));\n};\n\nconst loadLibrary = (\n  w: Window,\n  t: string,\n  pixelId: string,\n  advancedMatching: AdvancedMatching,\n  options: DebugOptions\n) => {\n  (w as any).TiktokAnalyticsObject = t;\n  var ttq = ((w as any)[t] = (w as any)[t] || []);\n  ttq.methods = [\n    'page',\n    'track',\n    'identify',\n    'instances',\n    'debug',\n    'on',\n    'off',\n    'once',\n    'ready',\n    'alias',\n    'group',\n    'enableCookie',\n    'disableCookie',\n  ];\n  ttq.setAndDefer = function(t: any, e: any) {\n    t[e] = function() {\n      t.push([e].concat(Array.prototype.slice.call(arguments, 0)));\n    };\n  };\n\n  for (var i = 0; i < ttq.methods.length; i++)\n    ttq.setAndDefer(ttq, ttq.methods[i]);\n  ttq.instance = function(t: any) {\n    for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++)\n      ttq.setAndDefer(e, ttq.methods[n]);\n    return e;\n  };\n  ttq.load = function(e: string, n: any) {\n    var i = 'https://analytics.tiktok.com/i18n/pixel/events.js';\n    ttq._i = ttq._i || {};\n    ttq._i[e] = [];\n    ttq._i[e]._u = i;\n    ttq._t = ttq._t || {};\n    ttq._t[e] = +new Date();\n    ttq._o = ttq._o || {};\n    ttq._o[e] = n || {};\n    var o = document.createElement('script');\n    o.type = 'text/javascript';\n    o.async = !0;\n    o.src = i + '?sdkid=' + e + '&lib=' + t;\n    var a = document.getElementsByTagName('script')[0];\n    a?.parentNode?.insertBefore(o, a);\n  };\n  if (!pixelId) {\n    warn('Please insert pixel id for initializing');\n  } else {\n    ttq.load(pixelId);\n    ttq.identify(advancedMatching);\n    ttq.page();\n    initialized = true;\n    debug = options.debug!;\n  }\n};\n\nconst defaultOptions: DebugOptions = {\n  debug: false,\n};\n\nconst TiktokPixel = {\n  async init(\n    pixelId: string,\n    advancedMatching: AdvancedMatching = {},\n    options = defaultOptions\n  ) {\n    initialized = typeof window !== 'undefined' && !!(window as any).ttq;\n    if (!initialized) {\n      loadLibrary(window, 'ttq', pixelId, advancedMatching, options);\n    }\n  },\n  pageView() {\n    const ttq = getLibrary();\n    ttq.page();\n  },\n\n  track(event: TiktokEvent, data?: TiktokParams, options: DebugOptions = {}) {\n    if (!verifyInit()) {\n      return;\n    }\n\n    if (!event) {\n      log(`please specificy an event name`);\n    }\n\n    const ttq = getLibrary();\n\n    ttq.track(event, data, options);\n\n    if (debug) {\n      log(`called ttq.track('${event}')`, data, options);\n\n      if (data) {\n        log('with data', data, options);\n      }\n    }\n  },\n};\n\nconst getLibrary = () => {\n  return (window as any).ttq;\n};\n\nexport default TiktokPixel;\n"],"names":["debug","initialized","warn","args","console","info","concat","verifyInit","log","loadLibrary","w","t","pixelId","advancedMatching","options","TiktokAnalyticsObject","ttq","methods","setAndDefer","e","push","Array","prototype","slice","call","arguments","i","length","instance","_i","n","load","_u","_t","Date","_o","o","document","createElement","type","async","src","a","getElementsByTagName","parentNode","insertBefore","identify","page","defaultOptions","TiktokPixel","init","window","pageView","getLibrary","track","event","data"],"mappings":"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"}